Спецификация алгоритма шифрования DNK-2
‎
‎Версия 2.0
‎
‎---
‎
‎1. Назначение
‎
‎Алгоритм DNK-2 предназначен для преобразования конфиденциальных данных в последовательность нуклеотидов (A, T, C, G) с возможностью последующего полного восстановления. Области применения:
‎
‎· Кодирование данных для синтеза и хранения в искусственных ДНК-носителях.
‎· Стеганографическая передача информации.
‎· Долгосрочное архивирование данных в биологических средах.
‎
‎---
‎
‎2. Основные параметры
‎
‎Параметр Значение
‎Входные данные Бинарные данные (текст в ASCII/UTF-8, файлы и т.д.)
‎Выходные данные Строка символов {A, T, C, G}
‎Коэффициент расширения 1 байт → 4 нуклеотида
‎Режим работы Поточный (XOR с ключевым потоком)
‎Длина ключа 256 бит (фиксировано)
‎
‎---
‎
‎3. Ключ и генерация ключевого потока
‎
‎3.1. Требования к ключу
‎
‎Ключ K представляет собой случайную бинарную последовательность длиной 256 бит. Использование осмысленных фраз в качестве ключа запрещено.
‎
‎Важно: Если ключ вводится пользователем как пароль, он обязательно должен быть преобразован в 256-битный ключ с помощью функции растяжения ключа:
‎
‎· Argon2id (рекомендуется)
‎· или PBKDF2 с числом итераций не менее 600 000
‎
‎3.2. Понятие Nonce (соль)
‎
‎Nonce (Number used ONCE) — это уникальное 96-битное (12 байт) число, которое генерируется заново для каждого сообщения.
‎
‎Назначение Nonce:
‎
‎· Гарантирует, что даже два одинаковых сообщения, зашифрованные одним ключом, будут выглядеть по-разному.
‎· Nonce передаётся открыто вместе с зашифрованным сообщением.
‎
‎Критическое правило: Запрещается использовать одну и ту же пару (Ключ + Nonce) для шифрования двух разных сообщений.
‎
‎3.3. Генератор ключевого потока
‎
‎В качестве генератора псевдослучайной последовательности используется ChaCha20 (рекомендуется) или AES-256 в режиме CTR.
‎
‎Вход генератора:
‎
‎· Ключ K (256 бит)
‎· Nonce N (96 бит)
‎
‎Выход генератора:
‎
‎· Ключевой поток P длиной, равной длине шифруемых данных (в байтах).
‎
‎Ключевой поток P обладает следующими свойствами:
‎
‎· Статистически неотличим от истинно случайной последовательности.
‎· Невозможно восстановить ключ или предсказать следующие биты потока, не зная ключа.
‎
‎3.4. Операция наложения
‎
‎Шифрование и дешифрование выполняются операцией XOR (исключающее ИЛИ) между исходными данными и ключевым потоком:
‎
‎C = M ⊕ P
‎M = C ⊕ P
‎
‎где:
‎
‎· M — исходные данные (plaintext)
‎· P — ключевой поток
‎· C — зашифрованные данные (ciphertext)
‎
‎---
‎
‎4. Алгоритм шифрования
‎
‎Шаг 1. Генерация Nonce
‎
‎Генерируется случайное 96-битное число N с использованием криптографически стойкого генератора случайных чисел (например, /dev/urandom).
‎
‎Шаг 2. Генерация ключевого потока
‎
‎На основе ключа K и Nonce N генератор (ChaCha20 или AES-CTR) вырабатывает ключевой поток P, длина которого равна длине исходного сообщения.
‎
‎Шаг 3. Наложение ключа
‎
‎Каждый байт исходного сообщения складывается по XOR с соответствующим байтом ключевого потока. Результат — зашифрованная бинарная последовательность C.
‎
‎Шаг 4. Кодирование в нуклеотиды
‎
‎Зашифрованная последовательность C побайтно преобразуется в нуклеотиды. Каждый байт разбивается на 4 пары битов, которые заменяются по таблице:
‎
‎Биты Нуклеотид
‎00 A
‎01 C
‎10 G
‎11 T
‎
‎Таким образом, 1 байт (8 бит) → 4 нуклеотида.
‎
‎Шаг 5. Кодирование Nonce
‎
‎Nonce N (12 байт) также преобразуется в нуклеотиды по той же таблице:
‎12 байт = 96 бит = 48 пар бит → 24 нуклеотида.
‎
‎Шаг 6. Формирование выходного пакета
‎
‎Выходной пакет имеет строгую структуру:
‎
‎```
‎[Nonce в нуклеотидах (24 символа)]
‎[AAAA] (стартовый маркер)
‎[Зашифрованные данные в нуклеотидах]
‎[TTTT] (стоповый маркер)
‎```
‎
‎Пример структуры:
‎
‎```
‎AGCTAGCTAGCTAGCTAGCTAGCTAAAACGGTTACGGATCCTAGCTA...TTTT
‎|<-------- Nonce ------->|^маркер^|<-- Данные -->|^маркер^|
‎```
‎
‎---
‎
‎5. Алгоритм дешифрования
‎
‎Шаг 1. Извлечение Nonce
‎
‎Из начала полученной последовательности считываются первые 24 символа. Они декодируются в 12 байт по обратной таблице:
‎
‎Нуклеотид Биты
‎A 00
‎C 01
‎G 10
‎T 11
‎
‎Восстанавливается исходный Nonce N.
‎
‎Шаг 2. Проверка маркеров
‎
‎Проверяется, что следующие 4 символа после Nonce равны AAAA, а последние 4 символа всей последовательности равны TTTT. Если маркеры не совпадают — выдаётся ошибка.
‎
‎Шаг 3. Извлечение зашифрованных данных
‎
‎Удаляются стартовый маркер (AAAA) и стоповый маркер (TTTT). Оставшаяся последовательность нуклеотидов — это зашифрованные данные.
‎
‎Шаг 4. Декодирование нуклеотидов в биты
‎
‎Последовательность нуклеотидов разбивается на группы по 4. Каждый нуклеотид преобразуется в пару битов по обратной таблице. Восстанавливается зашифрованная бинарная последовательность C.
‎
‎Шаг 5. Генерация ключевого потока
‎
‎На основе исходного ключа K и извлечённого Nonce N запускается тот же генератор (ChaCha20 или AES-CTR), который выдаёт ключевой поток P, идентичный использованному при шифровании.
‎
‎Шаг 6. Снятие ключа
‎
‎Зашифрованная последовательность C складывается по XOR с ключевым потоком P. Восстанавливается исходное сообщение M:
‎
‎M = C ⊕ P
‎
‎Шаг 7. Преобразование в исходный формат
‎
‎Восстановленная бинарная последовательность интерпретируется согласно исходному формату данных (текст ASCII/UTF-8, файл и т.д.).
‎
‎---
‎
‎6. Контроль целостности (рекомендуется)
‎
‎Для обнаружения случайных ошибок или преднамеренных модификаций рекомендуется добавить в конец исходных данных (до шифрования) аутентификационный код:
‎
‎· BLAKE3 (рекомендуется, высокая скорость)
‎· SHA-256 (классический вариант)
‎· HMAC-SHA256 (если требуется ключевая аутентификация)
‎
‎Алгоритм действий:
‎
‎1. Вычислить хэш исходных данных.
‎2. Присоединить хэш к исходным данным.
‎3. Зашифровать полученный блок целиком.
‎4. При дешифровании проверить соответствие хэша.
‎
‎---
‎
‎7. Параметры криптостойкости
‎
‎Характеристика Значение
‎Сложность полного перебора ключа 2²⁵⁶ операций (физически невозможно)
‎Уникальность шифротекста Обеспечивается 96-битным Nonce
‎Защита от частотного анализа Полная маскировка статистики
‎Избыточность кодирования 4× (1 байт → 4 нуклеотида)
‎Максимальный размер сообщения Практически не ограничен (до 2⁶⁴ байт)
‎
‎---
‎
‎8. Требования к реализации
‎
‎8.1. Обязательные требования
‎
‎· Nonce должен генерироваться криптографически стойким ГСЧ для каждого сообщения.
‎· Запрещено использовать одинаковый Nonce с одним ключом более одного раза.
‎· Ключи должны храниться в защищённом хранилище и передаваться только по защищённым каналам.
‎
‎8.2. Рекомендации
‎
‎· Использовать ChaCha20 вместо AES-CTR на платформах без аппаратного ускорения AES.
‎· Добавлять контроль целостности (BLAKE3 или SHA-256) для обнаружения модификаций.
‎· При синтезе ДНК учитывать ограничения на гомополимеры (повторяющиеся нуклеотиды) — при необходимости добавить постобработку.
‎
‎8.3. Обработка ошибок
‎
‎· Несоответствие стартового или стопового маркера → ошибка, дешифрование прекращается.
‎· Несовпадение контрольной суммы → ошибка, данные считаются повреждёнными.
‎· Некорректный символ во входной последовательности (не A,T,C,G) → ошибка.
‎
‎---
‎
‎9. Пример работы
‎
‎Исходные данные: "Hi" (ASCII: 72, 105)
‎
‎Бинарно: 01001000 01101001
‎
‎Ключ K: (256 бит, для примера сокращён) 10101010...
‎
‎Nonce N: (96 бит, для примера) 11001100...
‎
‎Генерация потока P: (первые 16 бит) 10010110 00111010
‎
‎XOR (шифрование):
‎01001000 ⊕ 10010110 = 11011110
‎01101001 ⊕ 00111010 = 01010011
‎
‎Зашифрованные данные C: 11011110 01010011
‎
‎Кодирование в нуклеотиды:
‎1101 1110 0101 0011 (пары бит)
‎11=T, 01=C, 11=T, 10=G, 01=C, 01=C, 00=A, 11=T
‎
‎Результат: TCTGC CAT (с пробелом для наглядности)
‎
‎Кодирование Nonce: (даёт 24 нуклеотида, например) AGCTAGCTAGCT...
‎
‎Итоговый пакет:
‎AGCTAGCTAGCTAAAATC TGCCATTTTT
‎(где AGCTAGCTAGCT — Nonce, AAAA — маркер, TCTGCCAT — данные, TTTT — маркер)
‎
‎---
‎
‎10. Заключение
‎
‎Алгоритм DNK-2 версии 2.0 представляет собой полноценное криптографическое решение, сочетающее:
‎
‎· Современную поточную криптографию (ChaCha20/AES-CTR) с 256-битным ключом.
‎· Механизм уникальности (96-битный Nonce).
‎· Специализированное кодирование для совместимости с ДНК-носителями.
‎
‎При соблюдении всех требований реализации алгоритм обеспечивает уровень безопасности, достаточный для защиты конфиденциальной информации вплоть до уровня государственной тайны (при использовании утверждённых стандартов).
‎
‎© Разработчик: Алексей Казакевич
‎Версия документа: 2.0 от 21.02.26
